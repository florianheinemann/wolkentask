"use strict";

var enforceHTTPS = function() {
	return function(req, res, next) {
		console.log(req.protocol);
		console.log(req.secure);
		console.log(req.originalUrl);
		console.log(req.url);
		// todo: what happens if not set?
		var urlScheme = req.headers["x-forwarded-proto"];
		if(urlScheme === "https") {
			next();
		} else {
			// todo: what is with params?
			// todo: what is in case of POST?
			res.redirect("https://" + req.headers.host + req.originalUrl);
		}
		// todo: what is in case of other scheme?
	}
};

exports.HTTPS = enforceHTTPS;